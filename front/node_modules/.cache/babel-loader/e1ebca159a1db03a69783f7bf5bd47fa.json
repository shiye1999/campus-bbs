{"ast":null,"code":"import \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      userImg: require(\"../../src/assets/user.png\"),\n      user: localStorage.getItem(\"user\") ? JSON.parse(localStorage.getItem(\"user\")) : {},\n      userInfo: {},\n      subscriberNumber: 0,\n      publisherNumber: 0,\n      commentNumber: 0,\n      usernameForm: {\n        username: \"\"\n      },\n      passwordForm: {\n        password: \"\",\n        rePassword: \"\"\n      },\n      loading: false\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this.request.get(\"/user/\" + this.user.id).then(function (res) {\n      console.log(res);\n      _this.userInfo = res.data;\n    });\n    this.request.get(\"/user/relation/subscriberNumber\").then(function (res) {\n      console.log(res);\n      _this.publisherNumber = res.data;\n    });\n    this.request.get(\"/user/relation/publisherNumber\").then(function (res) {\n      console.log(res);\n      _this.subscriberNumber = res.data;\n    });\n    this.request.get(\"/comment/commentNumber/\" + this.user.id).then(function (res) {\n      console.log(res);\n      _this.commentNumber = res.data;\n    });\n  },\n  metheds: {\n    handleAvatarSuccess: function handleAvatarSuccess(res, file) {\n      this.userImg = URL.createObjectURL(file.raw);\n    },\n    beforeAvatarUpload: function beforeAvatarUpload(file) {\n      var isJPG = file.type === 'image/jpeg';\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG 格式!');\n      }\n\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n\n      return isJPG && isLt2M;\n    },\n    changePWD: function changePWD() {\n      var _this2 = this;\n\n      this.request.post(\"/user/updatePWD/\" + this.user.id, this.passwordForm).then(function (res) {\n        console.log(res);\n\n        if (res.code === \"200\") {\n          _this2.$message.success(\"修改成功\");\n\n          location.reload;\n        } else {\n          _this2.$message.error(res.msg);\n        }\n      });\n    },\n    changeName: function changeName() {\n      var _this3 = this;\n\n      this.request.post(\"/user/updateName/\" + this.user.id, this.usernameForm).then(function (res) {\n        console.log(res);\n\n        if (res.code === \"200\") {\n          _this3.$message.success(\"修改成功\");\n\n          location.reload;\n        } else {\n          _this3.$message.error(res.msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkFA;AACAA,MADA,kBACA;AACA;AACAC,mDADA;AAEAC,wFAFA;AAGAC,kBAHA;AAIAC,yBAJA;AAKAC,wBALA;AAMAC,sBANA;AAOAC;AACAC;AADA,OAPA;AAUAC;AACAC,oBADA;AAEAC;AAFA,OAVA;AAcAC;AAdA;AAgBA,GAlBA;AAmBAC,SAnBA,qBAmBA;AAAA;;AACA,mDACA;AACAC;AACA;AACA,KAJA;AAOA,6DACA;AACAA;AACA;AACA,KAJA;AAOA,4DACA;AACAA;AACA;AACA,KAJA;AAOA,oEACA;AACAA;AACA;AACA,KAJA;AAMA,GA/CA;AAgDAC;AACAC,uBADA,+BACAC,GADA,EACAC,IADA,EACA;AACA;AACA,KAHA;AAIAC,sBAJA,8BAIAD,IAJA,EAIA;AACA;AACA;;AAEA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA,KAfA;AAgBAE,aAhBA,uBAgBA;AAAA;;AACA;AACAN;;AACA;AACA;;AACAO;AACA,SAHA,MAGA;AACA;AACA;AACA,OARA;AASA,KA1BA;AA2BAC,cA3BA,wBA2BA;AAAA;;AACA;AACAR;;AACA;AACA;;AACAO;AACA,SAHA,MAGA;AACA;AACA;AACA,OARA;AASA;AArCA;AAhDA","names":["data","userImg","user","userInfo","subscriberNumber","publisherNumber","commentNumber","usernameForm","username","passwordForm","password","rePassword","loading","created","console","metheds","handleAvatarSuccess","res","file","beforeAvatarUpload","changePWD","location","changeName"],"sourceRoot":"views/User","sources":["basicInfo.vue"],"sourcesContent":["<template>\r\n    <el-row class=\"userInfo\" :gutter=\"20\">\r\n        <el-col :span=\"6\" style=\"height:600px\">\r\n            <el-card>\r\n                <el-row>\r\n                    <div align=\"center\">\r\n                        <img class=\"user\" :src=\"userImg\">\r\n                    </div>\r\n                    <el-descriptions class=\"userInfo\" title=\"\" :column=\"1\" border>\r\n                        <el-descriptions-item label=\"用户名\">{{userInfo.username}}</el-descriptions-item>\r\n                        <el-descriptions-item label=\"学号\">{{userInfo.schoolNumber}}</el-descriptions-item>\r\n                        <el-descriptions-item label=\"角色\" v-if=\"userInfo.authority == 1\">管理员</el-descriptions-item>\r\n                        <el-descriptions-item label=\"角色\" v-if=\"userInfo.authority == 2\">认证用户</el-descriptions-item>\r\n                        <el-descriptions-item label=\"角色\" v-if=\"userInfo.authority == 3\">普通用户</el-descriptions-item>\r\n                        <el-descriptions-item label=\"关注数\">{{subscriberNumber}}</el-descriptions-item>\r\n                        <el-descriptions-item label=\"粉丝数\">{{publisherNumber}}</el-descriptions-item>\r\n                        <el-descriptions-item label=\"总发帖数\">{{commentNumber}}</el-descriptions-item>\r\n                        <el-descriptions-item label=\"创建时间\">{{userInfo.createTime}}</el-descriptions-item>\r\n                    </el-descriptions>\r\n                </el-row>\r\n            </el-card>\r\n        </el-col>\r\n        <el-col :span=\"18\" class=\"box\">\r\n            <el-card style=\"height:200px\">\r\n                <div class=\"changeAvatar\">\r\n                    <div slot=\"header\" class=\"clearfix\">\r\n                        <span>修改头像</span>\r\n                    </div>\r\n                    <!-- <el-upload class=\"avatar-uploader\" action=\"https://jsonplaceholder.typicode.com/posts/\"\r\n                        :show-file-list=\"false\" :on-success=\"handleAvatarSuccess\" :before-upload=\"beforeAvatarUpload\">\r\n                        <img v-if=\"userImg\" :src=\"userImg\" class=\"avatar\">\r\n                        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                    </el-upload> -->\r\n                </div>\r\n            </el-card>\r\n            <el-card style=\"height:300px padding:20px\">\r\n                <div slot=\"header\" class=\"clearfix\" style=\"margin-top:20px\">\r\n                    <span>修改用户名</span>\r\n                </div>\r\n                <el-form autocomplete=\"on\" :model=\"usernameForm\" ref=\"usernameForm\" label-position=\"left\"\r\n                    :rules=\"rules\">\r\n                    <el-form-item prop=\"username\">\r\n                        <el-input name=\"username\" type=\"text\" v-model=\"usernameForm.username\" autocomplete=\"on\"\r\n                            placeholder=\"请输入新的用户名\">\r\n                            <span slot=\"prefix\"></span>\r\n                        </el-input>\r\n                    </el-form-item>\r\n                    <el-form-item style=\"margin-bottom: 20px\">\r\n                        <el-button style=\"width: 10%\" type=\"primary\" :loading=\"loading\"\r\n                            @click.native.prevent=\"changeName\">提交</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-card>\r\n            <el-card style=\"height:300px margin-top:20px\">\r\n                <div slot=\"header\" class=\"clearfix\">\r\n                    <span>修改密码</span>\r\n                </div>\r\n                <el-form autocomplete=\"on\" :model=\"passwordForm\" ref=\"passwordForm\" label-position=\"left\"\r\n                    :rules=\"rules\">\r\n                    <el-form-item prop=\"password\">\r\n                        <el-input name=\"password\" type=\"text\" v-model=\"passwordForm.password\" autocomplete=\"on\"\r\n                            placeholder=\"请输入旧的密码\">\r\n                            <span slot=\"prefix\"></span>\r\n                        </el-input>\r\n                    </el-form-item>\r\n                    <el-form-item prop=\"rePassword\">\r\n                        <el-input name=\"rePassword\" v-model=\"passwordForm.rePassword\" autocomplete=\"on\"\r\n                            placeholder=\"请输入新的密码\">\r\n                            <span slot=\"prefix\"></span><span slot=\"suffix\"></span>\r\n                        </el-input>\r\n                    </el-form-item>\r\n                    <el-form-item style=\"margin-bottom: 20px\">\r\n                        <el-button style=\"width: 10%\" type=\"primary\" :loading=\"loading\"\r\n                            @click.native.prevent=\"changePWD\">提交</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-card>\r\n        </el-col>\r\n    </el-row>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                userImg: require(\"../../src/assets/user.png\"),\r\n                user: localStorage.getItem(\"user\") ? JSON.parse(localStorage.getItem(\"user\")) : {},\r\n                userInfo: {},\r\n                subscriberNumber: 0,\r\n                publisherNumber: 0,\r\n                commentNumber: 0,\r\n                usernameForm: {\r\n                    username: \"\",\r\n                },\r\n                passwordForm: {\r\n                    password: \"\",\r\n                    rePassword: \"\"\r\n                },\r\n                loading: false,\r\n            }\r\n        },\r\n        created() {\r\n            this.request.get(\"/user/\" + this.user.id).then(\r\n                res => {\r\n                    console.log(res)\r\n                    this.userInfo = res.data\r\n                }\r\n            )\r\n\r\n            this.request.get(\"/user/relation/subscriberNumber\").then(\r\n                res => {\r\n                    console.log(res)\r\n                    this.publisherNumber = res.data\r\n                }\r\n            )\r\n\r\n            this.request.get(\"/user/relation/publisherNumber\").then(\r\n                res => {\r\n                    console.log(res)\r\n                    this.subscriberNumber = res.data\r\n                }\r\n            )\r\n\r\n            this.request.get(\"/comment/commentNumber/\" + this.user.id).then(\r\n                res => {\r\n                    console.log(res)\r\n                    this.commentNumber = res.data\r\n                }\r\n            )\r\n        },\r\n        metheds: {\r\n            handleAvatarSuccess(res, file) {\r\n                this.userImg = URL.createObjectURL(file.raw);\r\n            },\r\n            beforeAvatarUpload(file) {\r\n                const isJPG = file.type === 'image/jpeg';\r\n                const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n                if (!isJPG) {\r\n                    this.$message.error('上传头像图片只能是 JPG 格式!');\r\n                }\r\n                if (!isLt2M) {\r\n                    this.$message.error('上传头像图片大小不能超过 2MB!');\r\n                }\r\n                return isJPG && isLt2M;\r\n            },\r\n            changePWD() {\r\n                this.request.post(\"/user/updatePWD/\" + this.user.id, this.passwordForm).then(res => {\r\n                    console.log(res)\r\n                    if (res.code === \"200\") {\r\n                        this.$message.success(\"修改成功\")\r\n                        location.reload\r\n                    } else {\r\n                        this.$message.error(res.msg)\r\n                    }\r\n                })\r\n            },\r\n            changeName() {\r\n                this.request.post(\"/user/updateName/\"  + this.user.id, this.usernameForm).then(res => {\r\n                    console.log(res)\r\n                    if (res.code === \"200\") {\r\n                        this.$message.success(\"修改成功\")\r\n                        location.reload\r\n                    } else {\r\n                        this.$message.error(res.msg)\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    .el-card {\r\n\r\n        .user {\r\n            margin-top: 10px;\r\n            width: 80px;\r\n            height: 80px;\r\n            border-radius: 50%;\r\n        }\r\n\r\n        .userInfo {\r\n            margin-top: 20px;\r\n        }\r\n\r\n        margin-bottom:20px; //下边距\r\n    }\r\n\r\n    .el-col {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .el-input {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .el-button {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .box {\r\n        height: 80%;\r\n        display: flex;\r\n        flex-direction: column; //起作用的是这个，没有的话会变成下图的样子，卡片跑到右边去了\r\n    }\r\n\r\n\r\n    .changeAvatar {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .changeName {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .changePwd {\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .avatar-uploader .el-upload {\r\n        border: 1px dashed #d9d9d9;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        position: relative;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .avatar-uploader .el-upload:hover {\r\n        border-color: #409EFF;\r\n    }\r\n\r\n    .avatar-uploader-icon {\r\n        font-size: 28px;\r\n        color: #8c939d;\r\n        width: 98px;\r\n        height: 98px;\r\n        line-height: 98px;\r\n        text-align: center;\r\n    }\r\n\r\n    .avatar {\r\n        width: 98px;\r\n        height: 98px;\r\n        display: block;\r\n    }\r\n</style>"]},"metadata":{},"sourceType":"module"}